{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.initialize = void 0;\n\nconst zappar_client_1 = require(\"./gen/zappar-client\");\n\nconst drawplane_1 = require(\"./drawplane\");\n\nconst cameramodel_1 = require(\"./cameramodel\");\n\nconst gl_matrix_1 = require(\"gl-matrix\");\n\nconst worker_client_1 = require(\"./worker-client\");\n\nconst permission_1 = require(\"./permission\");\n\nconst facemesh_1 = require(\"./facemesh\");\n\nconst pipeline_1 = require(\"./pipeline\");\n\nconst camera_source_1 = require(\"./camera-source\");\n\nconst html_element_source_1 = require(\"./html-element-source\");\n\nconst facelandmark_1 = require(\"./facelandmark\");\n\nconst compatibility_1 = require(\"./compatibility\");\n\nconst loglevel_1 = require(\"./loglevel\");\n\nlet client;\n\nfunction initialize() {\n  if (client) return client;\n  let loaded = false;\n  worker_client_1.launchWorker().then(() => {\n    loglevel_1.zcout(\"Fully loaded\");\n    loaded = true;\n  });\n  let c = new zappar_client_1.zappar_client(ab => {\n    worker_client_1.messageManager.postOutgoingMessage({\n      t: \"zappar\",\n      d: ab\n    }, [ab]);\n  });\n\n  if (window.location.hostname.toLowerCase().indexOf(\".zappar.io\") > 0) {\n    let pathParts = window.location.pathname.split(\"/\");\n    if (pathParts.length > 1 && pathParts[1].length > 0) c.impl.analytics_project_id_set(\".wiz\" + pathParts[1]);\n  }\n\n  worker_client_1.messageManager.onIncomingMessage.bind(msg => {\n    var _a, _b;\n\n    switch (msg.t) {\n      case \"zappar\":\n        (_a = pipeline_1.Pipeline.get(msg.p)) === null || _a === void 0 ? void 0 : _a.pendingMessages.push(msg.d);\n        break;\n\n      case \"buf\":\n        c.serializer.bufferReturn(msg.d);\n        break;\n\n      case \"cameraFrameRecycleS2C\":\n        let msgt = msg;\n        (_b = pipeline_1.Pipeline.get(msgt.p)) === null || _b === void 0 ? void 0 : _b.cameraTokenReturn(msgt.token, msgt.d);\n        break;\n\n      case \"licerr\":\n        {\n          let div = document.createElement(\"div\");\n          div.innerHTML = \"Visit <a href='https://docs.zap.works/universal-ar/licensing/' style='color: white;'>our licensing page</a> to find out about hosting on your own domain.\";\n          div.style.position = \"absolute\";\n          div.style.bottom = \"20px\";\n          div.style.width = \"80%\";\n          div.style.backgroundColor = \"black\";\n          div.style.color = \"white\";\n          div.style.borderRadius = \"10px\";\n          div.style.padding = \"10px\";\n          div.style.fontFamily = \"sans-serif\";\n          div.style.textAlign = \"center\";\n          div.style.left = \"10%\";\n          div.style.zIndex = Number.MAX_SAFE_INTEGER.toString();\n          let span = document.createElement(\"span\");\n          span.innerText = \" (30)\";\n          div.append(span);\n          let indx = 30;\n          setInterval(function () {\n            indx--;\n            if (indx >= 0) span.innerText = \" (\" + indx.toString() + \")\";\n          }, 1000);\n          document.body.append(div);\n        }\n    }\n  });\n  client = Object.assign(Object.assign({}, c.impl), {\n    loaded: () => loaded,\n    camera_default_device_id: userFacing => userFacing ? camera_source_1.CameraSource.USER_DEFAULT_DEVICE_ID : camera_source_1.CameraSource.DEFAULT_DEVICE_ID,\n    camera_source_create: (p, deviceId) => camera_source_1.CameraSource.create(p, deviceId),\n    camera_source_destroy: cam => {\n      var _a;\n\n      return (_a = camera_source_1.CameraSource.get(cam)) === null || _a === void 0 ? void 0 : _a.destroy();\n    },\n    camera_source_pause: cam => {\n      var _a;\n\n      return (_a = camera_source_1.CameraSource.get(cam)) === null || _a === void 0 ? void 0 : _a.pause();\n    },\n    camera_source_start: cam => {\n      var _a;\n\n      return (_a = camera_source_1.CameraSource.get(cam)) === null || _a === void 0 ? void 0 : _a.start();\n    },\n    pipeline_create: () => pipeline_1.Pipeline.create(c.impl, worker_client_1.messageManager),\n    pipeline_frame_update: p => {\n      var _a;\n\n      return (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.frameUpdate(c);\n    },\n    pipeline_camera_frame_draw_gl: (pipeline, screenWidth, screenHeight, mirror) => {\n      var _a;\n\n      (_a = pipeline_1.Pipeline.get(pipeline)) === null || _a === void 0 ? void 0 : _a.cameraFrameDrawGL(screenWidth, screenHeight, mirror);\n    },\n    draw_plane: (gl, projectionMatrix, cameraMatrix, targetMatrix, texture) => {\n      drawplane_1.drawPlane(gl, projectionMatrix, cameraMatrix, targetMatrix, texture);\n    },\n    pipeline_draw_face: (p, projectionMatrix, cameraMatrix, targetMatrix, o) => {\n      var _a;\n\n      let obj = facemesh_1.getFaceMesh(o);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call draw_face on a destroyed zappar_face_mesh_t\");\n        return new Uint16Array();\n      }\n\n      (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.drawFace(projectionMatrix, cameraMatrix, targetMatrix, obj);\n    },\n    pipeline_draw_face_project: (p, matrix, vertices, uvMatrix, uvs, indices, texture) => {\n      var _a;\n\n      (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.drawFaceProject(matrix, vertices, uvMatrix, uvs, indices, texture);\n    },\n    projection_matrix_from_camera_model: cameramodel_1.projectionMatrix,\n    projection_matrix_from_camera_model_ext: cameramodel_1.projectionMatrix,\n    pipeline_process_gl: p => {\n      var _a;\n\n      return (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.processGL();\n    },\n    pipeline_gl_context_set: (p, gl, texturePool) => {\n      var _a;\n\n      return (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.glContextSet(gl, texturePool);\n    },\n    pipeline_gl_context_lost: p => {\n      var _a;\n\n      return (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.glContextLost();\n    },\n    pipeline_camera_frame_upload_gl: () => {},\n    pipeline_camera_frame_texture_gl: p => {\n      var _a;\n\n      return (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.cameraFrameTexture();\n    },\n    pipeline_camera_frame_texture_matrix: (p, sw, sh, mirror) => {\n      var _a;\n\n      return ((_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.cameraFrameTextureMatrix(sw, sh, mirror)) || gl_matrix_1.mat4.create();\n    },\n    pipeline_camera_frame_user_facing: p => {\n      var _a;\n\n      return ((_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.cameraFrameUserFacing()) || false;\n    },\n    pipeline_camera_pose_default: () => gl_matrix_1.mat4.create(),\n    pipeline_camera_pose_with_attitude: (p, mirror) => {\n      var _a;\n\n      return ((_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.cameraPoseWithAttitude(mirror)) || gl_matrix_1.mat4.create();\n    },\n    pipeline_camera_pose_with_origin: (p, o) => {\n      let res = gl_matrix_1.mat4.create();\n      gl_matrix_1.mat4.invert(res, o);\n      return res;\n    },\n    instant_world_tracker_anchor_pose_camera_relative: (o, mirror) => {\n      let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.instant_world_tracker_anchor_pose_raw(o));\n\n      if (mirror) {\n        let scale = gl_matrix_1.mat4.create();\n        gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n        gl_matrix_1.mat4.multiply(res, scale, res);\n        gl_matrix_1.mat4.multiply(res, res, scale);\n      }\n\n      return res;\n    },\n    instant_world_tracker_anchor_pose: (o, cameraPose, mirror) => {\n      let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.instant_world_tracker_anchor_pose_raw(o));\n\n      if (mirror) {\n        let scale = gl_matrix_1.mat4.create();\n        gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n        gl_matrix_1.mat4.multiply(res, scale, res);\n        gl_matrix_1.mat4.multiply(res, res, scale);\n      }\n\n      gl_matrix_1.mat4.multiply(res, cameraPose, res);\n      return res;\n    },\n    image_tracker_anchor_pose_camera_relative: (o, indx, mirror) => {\n      let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.image_tracker_anchor_pose_raw(o, indx));\n\n      if (mirror) {\n        let scale = gl_matrix_1.mat4.create();\n        gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n        gl_matrix_1.mat4.multiply(res, scale, res);\n        gl_matrix_1.mat4.multiply(res, res, scale);\n      }\n\n      return res;\n    },\n    image_tracker_anchor_pose: (o, indx, cameraPose, mirror) => {\n      let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.image_tracker_anchor_pose_raw(o, indx));\n\n      if (mirror) {\n        let scale = gl_matrix_1.mat4.create();\n        gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n        gl_matrix_1.mat4.multiply(res, scale, res);\n        gl_matrix_1.mat4.multiply(res, res, scale);\n      }\n\n      gl_matrix_1.mat4.multiply(res, cameraPose, res);\n      return res;\n    },\n    face_tracker_anchor_pose_camera_relative: (o, indx, mirror) => {\n      let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.face_tracker_anchor_pose_raw(o, indx));\n\n      if (mirror) {\n        let scale = gl_matrix_1.mat4.create();\n        gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n        gl_matrix_1.mat4.multiply(res, scale, res);\n        gl_matrix_1.mat4.multiply(res, res, scale);\n      }\n\n      return res;\n    },\n    face_tracker_anchor_pose: (o, indx, cameraPose, mirror) => {\n      let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.face_tracker_anchor_pose_raw(o, indx));\n\n      if (mirror) {\n        let scale = gl_matrix_1.mat4.create();\n        gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n        gl_matrix_1.mat4.multiply(res, scale, res);\n        gl_matrix_1.mat4.multiply(res, res, scale);\n      }\n\n      gl_matrix_1.mat4.multiply(res, cameraPose, res);\n      return res;\n    },\n    face_tracker_model_load_default: o => __awaiter(this, void 0, void 0, function* () {\n      yield loadDefaultFaceModel(o);\n    }),\n    face_mesh_create: () => {\n      return facemesh_1.createFaceMesh();\n    },\n    face_mesh_destroy: m => {\n      facemesh_1.destroyFaceMesh(m);\n    },\n    face_mesh_indices: m => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_indices on a destroyed zappar_face_mesh_t\");\n        return new Uint16Array();\n      }\n\n      return obj.getIndices();\n    },\n    face_mesh_indices_size: m => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_indices_size on a destroyed zappar_face_mesh_t\");\n        return 0;\n      }\n\n      return obj.getIndices().length;\n    },\n    face_mesh_uvs: m => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_uvs on a destroyed zappar_face_mesh_t\");\n        return new Float32Array();\n      }\n\n      return obj.getUVs();\n    },\n    face_mesh_uvs_size: m => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_uvs_size on a destroyed zappar_face_mesh_t\");\n        return 0;\n      }\n\n      return obj.getUVs().length;\n    },\n    face_mesh_vertices: m => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_vertices on a destroyed zappar_face_mesh_t\");\n        return new Float32Array();\n      }\n\n      return obj.getVertices();\n    },\n    face_mesh_vertices_size: m => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_vertices_size on a destroyed zappar_face_mesh_t\");\n        return 0;\n      }\n\n      return obj.getVertices().length;\n    },\n    face_mesh_normals: m => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_normals on a destroyed zappar_face_mesh_t\");\n        return new Float32Array();\n      }\n\n      return obj.getNormals();\n    },\n    face_mesh_normals_size: m => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_normals_size on a destroyed zappar_face_mesh_t\");\n        return 0;\n      }\n\n      return obj.getNormals().length;\n    },\n    face_mesh_load_from_memory: (m, ab, fillMouth, fillEyeL, fillEyeR, fillNeck) => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_load_from_memory on a destroyed zappar_face_mesh_t\");\n        return;\n      }\n\n      obj.loadFromMemory(ab, fillMouth, fillEyeL, fillEyeR, fillNeck);\n    },\n    face_mesh_update: (m, identity, expression, mirrored) => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_update on a destroyed zappar_face_mesh_t\");\n        return;\n      }\n\n      obj.update(identity, expression, mirrored);\n    },\n    face_mesh_load_default: m => __awaiter(this, void 0, void 0, function* () {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_load_default on a destroyed zappar_face_mesh_t\");\n        return;\n      }\n\n      let url = require(\"file-loader!./face_mesh_face_model.zbin\");\n\n      if (url.default !== undefined) url = url.default;\n      let req = yield fetch(url);\n      obj.loadFromMemory(yield req.arrayBuffer(), false, false, false, false);\n    }),\n    face_mesh_load_default_face: (m, fillMouth, fillEyeL, fillEyeR) => __awaiter(this, void 0, void 0, function* () {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_load_default_face on a destroyed zappar_face_mesh_t\");\n        return;\n      }\n\n      let url = require(\"file-loader!./face_mesh_face_model.zbin\");\n\n      if (url.default !== undefined) url = url.default;\n      let req = yield fetch(url);\n      obj.loadFromMemory(yield req.arrayBuffer(), fillMouth, fillEyeL, fillEyeR, false);\n    }),\n    face_mesh_load_default_full_head_simplified: (m, fillMouth, fillEyeL, fillEyeR, fillNeck) => __awaiter(this, void 0, void 0, function* () {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_load_default_full_head_simplified on a destroyed zappar_face_mesh_t\");\n        return;\n      }\n\n      let url = require(\"file-loader!./face_mesh_full_head_simplified_model.zbin\");\n\n      if (url.default !== undefined) url = url.default;\n      let req = yield fetch(url);\n      obj.loadFromMemory(yield req.arrayBuffer(), fillMouth, fillEyeL, fillEyeR, fillNeck);\n    }),\n    face_mesh_loaded_version: m => {\n      let obj = facemesh_1.getFaceMesh(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_mesh_load_default on a destroyed zappar_face_mesh_t\");\n        return -1;\n      }\n\n      return obj.getModelVersion();\n    },\n    face_landmark_create: n => {\n      return facelandmark_1.createFaceLandmark(n);\n    },\n    face_landmark_destroy: m => {\n      facelandmark_1.destroyFaceLandmark(m);\n    },\n    face_landmark_update: (m, identity, expression, mirrored) => {\n      let obj = facelandmark_1.getFaceLandmark(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_landmark_update on a destroyed zappar_face_landmark_t\");\n        return;\n      }\n\n      obj.update(identity, expression, mirrored);\n    },\n    face_landmark_anchor_pose: m => {\n      let obj = facelandmark_1.getFaceLandmark(m);\n\n      if (!obj) {\n        loglevel_1.zcwarn(\"attempting to call face_landmark_anchor_pose on a destroyed zappar_face_landmark_t\");\n        return gl_matrix_1.mat4.create();\n      }\n\n      return obj.anchor_pose;\n    },\n    html_element_source_create: (pipeline, elm) => html_element_source_1.HTMLElementSource.createVideoElementSource(pipeline, elm),\n    html_element_source_start: o => {\n      var _a;\n\n      return (_a = html_element_source_1.HTMLElementSource.getVideoElementSource(o)) === null || _a === void 0 ? void 0 : _a.start();\n    },\n    html_element_source_pause: o => {\n      var _a;\n\n      return (_a = html_element_source_1.HTMLElementSource.getVideoElementSource(o)) === null || _a === void 0 ? void 0 : _a.pause();\n    },\n    html_element_source_destroy: o => {\n      var _a;\n\n      return (_a = html_element_source_1.HTMLElementSource.getVideoElementSource(o)) === null || _a === void 0 ? void 0 : _a.destroy();\n    },\n    permission_granted_all: permission_1.permissionGrantedAll,\n    permission_granted_camera: permission_1.permissionGrantedCamera,\n    permission_granted_motion: permission_1.permissionGrantedMotion,\n    permission_denied_any: permission_1.permissionDeniedAny,\n    permission_denied_camera: permission_1.permissionDeniedCamera,\n    permission_denied_motion: permission_1.permissionDeniedMotion,\n    permission_request_motion: permission_1.permissionRequestMotion,\n    permission_request_camera: permission_1.permissionRequestCamera,\n    permission_request_all: permission_1.permissionRequestAll,\n    permission_request_ui: permission_1.permissionRequestUI,\n    permission_request_ui_promise: permission_1.permissionRequestUI,\n    permission_denied_ui: permission_1.permissionDeniedUI,\n    browser_incompatible: compatibility_1.default.incompatible,\n    browser_incompatible_ui: compatibility_1.default.incompatible_ui,\n    log_level_set: l => {\n      loglevel_1.setLogLevel(l);\n      c.impl.log_level_set(l);\n    }\n  });\n  return client;\n}\n\nexports.initialize = initialize;\n\nfunction loadDefaultFaceModel(o) {\n  return __awaiter(this, void 0, void 0, function* () {\n    let url = require(\"file-loader!./face_tracking_model.zbin\");\n\n    if (url.default !== undefined) url = url.default;\n    let data = yield fetch(url);\n    let ab = yield data.arrayBuffer();\n    client === null || client === void 0 ? void 0 : client.face_tracker_model_load_from_memory(o, ab);\n  });\n}","map":{"version":3,"sources":["/Users/StanleyWalker/Desktop/react-three-example-face-tracking-helmet-1/node_modules/@zappar/zappar-cv/lib/native.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","initialize","zappar_client_1","require","drawplane_1","cameramodel_1","gl_matrix_1","worker_client_1","permission_1","facemesh_1","pipeline_1","camera_source_1","html_element_source_1","facelandmark_1","compatibility_1","loglevel_1","client","loaded","launchWorker","zcout","c","zappar_client","ab","messageManager","postOutgoingMessage","t","d","window","location","hostname","toLowerCase","indexOf","pathParts","pathname","split","length","impl","analytics_project_id_set","onIncomingMessage","bind","msg","_a","_b","Pipeline","get","p","pendingMessages","push","serializer","bufferReturn","msgt","cameraTokenReturn","token","div","document","createElement","innerHTML","style","position","bottom","width","backgroundColor","color","borderRadius","padding","fontFamily","textAlign","left","zIndex","Number","MAX_SAFE_INTEGER","toString","span","innerText","append","indx","setInterval","body","assign","camera_default_device_id","userFacing","CameraSource","USER_DEFAULT_DEVICE_ID","DEFAULT_DEVICE_ID","camera_source_create","deviceId","create","camera_source_destroy","cam","destroy","camera_source_pause","pause","camera_source_start","start","pipeline_create","pipeline_frame_update","frameUpdate","pipeline_camera_frame_draw_gl","pipeline","screenWidth","screenHeight","mirror","cameraFrameDrawGL","draw_plane","gl","projectionMatrix","cameraMatrix","targetMatrix","texture","drawPlane","pipeline_draw_face","o","obj","getFaceMesh","zcwarn","Uint16Array","drawFace","pipeline_draw_face_project","matrix","vertices","uvMatrix","uvs","indices","drawFaceProject","projection_matrix_from_camera_model","projection_matrix_from_camera_model_ext","pipeline_process_gl","processGL","pipeline_gl_context_set","texturePool","glContextSet","pipeline_gl_context_lost","glContextLost","pipeline_camera_frame_upload_gl","pipeline_camera_frame_texture_gl","cameraFrameTexture","pipeline_camera_frame_texture_matrix","sw","sh","cameraFrameTextureMatrix","mat4","pipeline_camera_frame_user_facing","cameraFrameUserFacing","pipeline_camera_pose_default","pipeline_camera_pose_with_attitude","cameraPoseWithAttitude","pipeline_camera_pose_with_origin","res","invert","instant_world_tracker_anchor_pose_camera_relative","applyScreenCounterRotation","undefined","instant_world_tracker_anchor_pose_raw","scale","fromScaling","multiply","instant_world_tracker_anchor_pose","cameraPose","image_tracker_anchor_pose_camera_relative","image_tracker_anchor_pose_raw","image_tracker_anchor_pose","face_tracker_anchor_pose_camera_relative","face_tracker_anchor_pose_raw","face_tracker_anchor_pose","face_tracker_model_load_default","loadDefaultFaceModel","face_mesh_create","createFaceMesh","face_mesh_destroy","m","destroyFaceMesh","face_mesh_indices","getIndices","face_mesh_indices_size","face_mesh_uvs","Float32Array","getUVs","face_mesh_uvs_size","face_mesh_vertices","getVertices","face_mesh_vertices_size","face_mesh_normals","getNormals","face_mesh_normals_size","face_mesh_load_from_memory","fillMouth","fillEyeL","fillEyeR","fillNeck","loadFromMemory","face_mesh_update","identity","expression","mirrored","update","face_mesh_load_default","url","default","req","fetch","arrayBuffer","face_mesh_load_default_face","face_mesh_load_default_full_head_simplified","face_mesh_loaded_version","getModelVersion","face_landmark_create","n","createFaceLandmark","face_landmark_destroy","destroyFaceLandmark","face_landmark_update","getFaceLandmark","face_landmark_anchor_pose","anchor_pose","html_element_source_create","elm","HTMLElementSource","createVideoElementSource","html_element_source_start","getVideoElementSource","html_element_source_pause","html_element_source_destroy","permission_granted_all","permissionGrantedAll","permission_granted_camera","permissionGrantedCamera","permission_granted_motion","permissionGrantedMotion","permission_denied_any","permissionDeniedAny","permission_denied_camera","permissionDeniedCamera","permission_denied_motion","permissionDeniedMotion","permission_request_motion","permissionRequestMotion","permission_request_camera","permissionRequestCamera","permission_request_all","permissionRequestAll","permission_request_ui","permissionRequestUI","permission_request_ui_promise","permission_denied_ui","permissionDeniedUI","browser_incompatible","incompatible","browser_incompatible_ui","incompatible_ui","log_level_set","l","setLogLevel","data","face_tracker_model_load_from_memory"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.initialize = void 0;\nconst zappar_client_1 = require(\"./gen/zappar-client\");\nconst drawplane_1 = require(\"./drawplane\");\nconst cameramodel_1 = require(\"./cameramodel\");\nconst gl_matrix_1 = require(\"gl-matrix\");\nconst worker_client_1 = require(\"./worker-client\");\nconst permission_1 = require(\"./permission\");\nconst facemesh_1 = require(\"./facemesh\");\nconst pipeline_1 = require(\"./pipeline\");\nconst camera_source_1 = require(\"./camera-source\");\nconst html_element_source_1 = require(\"./html-element-source\");\nconst facelandmark_1 = require(\"./facelandmark\");\nconst compatibility_1 = require(\"./compatibility\");\nconst loglevel_1 = require(\"./loglevel\");\nlet client;\nfunction initialize() {\n    if (client)\n        return client;\n    let loaded = false;\n    worker_client_1.launchWorker().then(() => {\n        loglevel_1.zcout(\"Fully loaded\");\n        loaded = true;\n    });\n    let c = new zappar_client_1.zappar_client(ab => {\n        worker_client_1.messageManager.postOutgoingMessage({\n            t: \"zappar\",\n            d: ab\n        }, [ab]);\n    });\n    if (window.location.hostname.toLowerCase().indexOf(\".zappar.io\") > 0) {\n        let pathParts = window.location.pathname.split(\"/\");\n        if (pathParts.length > 1 && pathParts[1].length > 0)\n            c.impl.analytics_project_id_set(\".wiz\" + pathParts[1]);\n    }\n    worker_client_1.messageManager.onIncomingMessage.bind(msg => {\n        var _a, _b;\n        switch (msg.t) {\n            case \"zappar\":\n                (_a = pipeline_1.Pipeline.get(msg.p)) === null || _a === void 0 ? void 0 : _a.pendingMessages.push(msg.d);\n                break;\n            case \"buf\":\n                c.serializer.bufferReturn(msg.d);\n                break;\n            case \"cameraFrameRecycleS2C\":\n                let msgt = msg;\n                (_b = pipeline_1.Pipeline.get(msgt.p)) === null || _b === void 0 ? void 0 : _b.cameraTokenReturn(msgt.token, msgt.d);\n                break;\n            case \"licerr\": {\n                let div = document.createElement(\"div\");\n                div.innerHTML = \"Visit <a href='https://docs.zap.works/universal-ar/licensing/' style='color: white;'>our licensing page</a> to find out about hosting on your own domain.\";\n                div.style.position = \"absolute\";\n                div.style.bottom = \"20px\";\n                div.style.width = \"80%\";\n                div.style.backgroundColor = \"black\";\n                div.style.color = \"white\";\n                div.style.borderRadius = \"10px\";\n                div.style.padding = \"10px\";\n                div.style.fontFamily = \"sans-serif\";\n                div.style.textAlign = \"center\";\n                div.style.left = \"10%\";\n                div.style.zIndex = Number.MAX_SAFE_INTEGER.toString();\n                let span = document.createElement(\"span\");\n                span.innerText = \" (30)\";\n                div.append(span);\n                let indx = 30;\n                setInterval(function () {\n                    indx--;\n                    if (indx >= 0)\n                        span.innerText = \" (\" + indx.toString() + \")\";\n                }, 1000);\n                document.body.append(div);\n            }\n        }\n    });\n    client = Object.assign(Object.assign({}, c.impl), { loaded: () => loaded, camera_default_device_id: userFacing => userFacing ? camera_source_1.CameraSource.USER_DEFAULT_DEVICE_ID : camera_source_1.CameraSource.DEFAULT_DEVICE_ID, camera_source_create: (p, deviceId) => camera_source_1.CameraSource.create(p, deviceId), camera_source_destroy: cam => { var _a; return (_a = camera_source_1.CameraSource.get(cam)) === null || _a === void 0 ? void 0 : _a.destroy(); }, camera_source_pause: cam => { var _a; return (_a = camera_source_1.CameraSource.get(cam)) === null || _a === void 0 ? void 0 : _a.pause(); }, camera_source_start: cam => { var _a; return (_a = camera_source_1.CameraSource.get(cam)) === null || _a === void 0 ? void 0 : _a.start(); }, pipeline_create: () => pipeline_1.Pipeline.create(c.impl, worker_client_1.messageManager), pipeline_frame_update: (p) => { var _a; return (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.frameUpdate(c); }, pipeline_camera_frame_draw_gl: (pipeline, screenWidth, screenHeight, mirror) => {\n            var _a;\n            (_a = pipeline_1.Pipeline.get(pipeline)) === null || _a === void 0 ? void 0 : _a.cameraFrameDrawGL(screenWidth, screenHeight, mirror);\n        }, draw_plane: (gl, projectionMatrix, cameraMatrix, targetMatrix, texture) => {\n            drawplane_1.drawPlane(gl, projectionMatrix, cameraMatrix, targetMatrix, texture);\n        }, pipeline_draw_face: (p, projectionMatrix, cameraMatrix, targetMatrix, o) => {\n            var _a;\n            let obj = facemesh_1.getFaceMesh(o);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call draw_face on a destroyed zappar_face_mesh_t\");\n                return new Uint16Array();\n            }\n            (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.drawFace(projectionMatrix, cameraMatrix, targetMatrix, obj);\n        }, pipeline_draw_face_project: (p, matrix, vertices, uvMatrix, uvs, indices, texture) => {\n            var _a;\n            (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.drawFaceProject(matrix, vertices, uvMatrix, uvs, indices, texture);\n        }, projection_matrix_from_camera_model: cameramodel_1.projectionMatrix, projection_matrix_from_camera_model_ext: cameramodel_1.projectionMatrix, pipeline_process_gl: p => { var _a; return (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.processGL(); }, pipeline_gl_context_set: (p, gl, texturePool) => { var _a; return (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.glContextSet(gl, texturePool); }, pipeline_gl_context_lost: (p) => { var _a; return (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.glContextLost(); }, pipeline_camera_frame_upload_gl: () => { }, pipeline_camera_frame_texture_gl: p => { var _a; return (_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.cameraFrameTexture(); }, pipeline_camera_frame_texture_matrix: (p, sw, sh, mirror) => { var _a; return ((_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.cameraFrameTextureMatrix(sw, sh, mirror)) || gl_matrix_1.mat4.create(); }, pipeline_camera_frame_user_facing: p => { var _a; return ((_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.cameraFrameUserFacing()) || false; }, pipeline_camera_pose_default: () => gl_matrix_1.mat4.create(), pipeline_camera_pose_with_attitude: (p, mirror) => { var _a; return ((_a = pipeline_1.Pipeline.get(p)) === null || _a === void 0 ? void 0 : _a.cameraPoseWithAttitude(mirror)) || gl_matrix_1.mat4.create(); }, pipeline_camera_pose_with_origin: (p, o) => { let res = gl_matrix_1.mat4.create(); gl_matrix_1.mat4.invert(res, o); return res; }, instant_world_tracker_anchor_pose_camera_relative: (o, mirror) => {\n            let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.instant_world_tracker_anchor_pose_raw(o));\n            if (mirror) {\n                let scale = gl_matrix_1.mat4.create();\n                gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n                gl_matrix_1.mat4.multiply(res, scale, res);\n                gl_matrix_1.mat4.multiply(res, res, scale);\n            }\n            return res;\n        }, instant_world_tracker_anchor_pose: (o, cameraPose, mirror) => {\n            let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.instant_world_tracker_anchor_pose_raw(o));\n            if (mirror) {\n                let scale = gl_matrix_1.mat4.create();\n                gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n                gl_matrix_1.mat4.multiply(res, scale, res);\n                gl_matrix_1.mat4.multiply(res, res, scale);\n            }\n            gl_matrix_1.mat4.multiply(res, cameraPose, res);\n            return res;\n        }, image_tracker_anchor_pose_camera_relative: (o, indx, mirror) => {\n            let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.image_tracker_anchor_pose_raw(o, indx));\n            if (mirror) {\n                let scale = gl_matrix_1.mat4.create();\n                gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n                gl_matrix_1.mat4.multiply(res, scale, res);\n                gl_matrix_1.mat4.multiply(res, res, scale);\n            }\n            return res;\n        }, image_tracker_anchor_pose: (o, indx, cameraPose, mirror) => {\n            let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.image_tracker_anchor_pose_raw(o, indx));\n            if (mirror) {\n                let scale = gl_matrix_1.mat4.create();\n                gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n                gl_matrix_1.mat4.multiply(res, scale, res);\n                gl_matrix_1.mat4.multiply(res, res, scale);\n            }\n            gl_matrix_1.mat4.multiply(res, cameraPose, res);\n            return res;\n        }, face_tracker_anchor_pose_camera_relative: (o, indx, mirror) => {\n            let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.face_tracker_anchor_pose_raw(o, indx));\n            if (mirror) {\n                let scale = gl_matrix_1.mat4.create();\n                gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n                gl_matrix_1.mat4.multiply(res, scale, res);\n                gl_matrix_1.mat4.multiply(res, res, scale);\n            }\n            return res;\n        }, face_tracker_anchor_pose: (o, indx, cameraPose, mirror) => {\n            let res = pipeline_1.applyScreenCounterRotation(undefined, c.impl.face_tracker_anchor_pose_raw(o, indx));\n            if (mirror) {\n                let scale = gl_matrix_1.mat4.create();\n                gl_matrix_1.mat4.fromScaling(scale, [-1, 1, 1]);\n                gl_matrix_1.mat4.multiply(res, scale, res);\n                gl_matrix_1.mat4.multiply(res, res, scale);\n            }\n            gl_matrix_1.mat4.multiply(res, cameraPose, res);\n            return res;\n        }, face_tracker_model_load_default: (o) => __awaiter(this, void 0, void 0, function* () {\n            yield loadDefaultFaceModel(o);\n        }), face_mesh_create: () => {\n            return facemesh_1.createFaceMesh();\n        }, face_mesh_destroy: (m) => {\n            facemesh_1.destroyFaceMesh(m);\n        }, face_mesh_indices: (m) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_indices on a destroyed zappar_face_mesh_t\");\n                return new Uint16Array();\n            }\n            return obj.getIndices();\n        }, face_mesh_indices_size: (m) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_indices_size on a destroyed zappar_face_mesh_t\");\n                return 0;\n            }\n            return obj.getIndices().length;\n        }, face_mesh_uvs: (m) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_uvs on a destroyed zappar_face_mesh_t\");\n                return new Float32Array();\n            }\n            return obj.getUVs();\n        }, face_mesh_uvs_size: (m) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_uvs_size on a destroyed zappar_face_mesh_t\");\n                return 0;\n            }\n            return obj.getUVs().length;\n        }, face_mesh_vertices: (m) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_vertices on a destroyed zappar_face_mesh_t\");\n                return new Float32Array();\n            }\n            return obj.getVertices();\n        }, face_mesh_vertices_size: (m) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_vertices_size on a destroyed zappar_face_mesh_t\");\n                return 0;\n            }\n            return obj.getVertices().length;\n        }, face_mesh_normals: (m) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_normals on a destroyed zappar_face_mesh_t\");\n                return new Float32Array();\n            }\n            return obj.getNormals();\n        }, face_mesh_normals_size: (m) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_normals_size on a destroyed zappar_face_mesh_t\");\n                return 0;\n            }\n            return obj.getNormals().length;\n        }, face_mesh_load_from_memory: (m, ab, fillMouth, fillEyeL, fillEyeR, fillNeck) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_load_from_memory on a destroyed zappar_face_mesh_t\");\n                return;\n            }\n            obj.loadFromMemory(ab, fillMouth, fillEyeL, fillEyeR, fillNeck);\n        }, face_mesh_update: (m, identity, expression, mirrored) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_update on a destroyed zappar_face_mesh_t\");\n                return;\n            }\n            obj.update(identity, expression, mirrored);\n        }, face_mesh_load_default: (m) => __awaiter(this, void 0, void 0, function* () {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_load_default on a destroyed zappar_face_mesh_t\");\n                return;\n            }\n            let url = require(\"file-loader!./face_mesh_face_model.zbin\");\n            if (url.default !== undefined)\n                url = url.default;\n            let req = yield fetch(url);\n            obj.loadFromMemory(yield req.arrayBuffer(), false, false, false, false);\n        }), face_mesh_load_default_face: (m, fillMouth, fillEyeL, fillEyeR) => __awaiter(this, void 0, void 0, function* () {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_load_default_face on a destroyed zappar_face_mesh_t\");\n                return;\n            }\n            let url = require(\"file-loader!./face_mesh_face_model.zbin\");\n            if (url.default !== undefined)\n                url = url.default;\n            let req = yield fetch(url);\n            obj.loadFromMemory(yield req.arrayBuffer(), fillMouth, fillEyeL, fillEyeR, false);\n        }), face_mesh_load_default_full_head_simplified: (m, fillMouth, fillEyeL, fillEyeR, fillNeck) => __awaiter(this, void 0, void 0, function* () {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_load_default_full_head_simplified on a destroyed zappar_face_mesh_t\");\n                return;\n            }\n            let url = require(\"file-loader!./face_mesh_full_head_simplified_model.zbin\");\n            if (url.default !== undefined)\n                url = url.default;\n            let req = yield fetch(url);\n            obj.loadFromMemory(yield req.arrayBuffer(), fillMouth, fillEyeL, fillEyeR, fillNeck);\n        }), face_mesh_loaded_version: (m) => {\n            let obj = facemesh_1.getFaceMesh(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_mesh_load_default on a destroyed zappar_face_mesh_t\");\n                return -1;\n            }\n            return obj.getModelVersion();\n        }, face_landmark_create: (n) => {\n            return facelandmark_1.createFaceLandmark(n);\n        }, face_landmark_destroy: (m) => {\n            facelandmark_1.destroyFaceLandmark(m);\n        }, face_landmark_update: (m, identity, expression, mirrored) => {\n            let obj = facelandmark_1.getFaceLandmark(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_landmark_update on a destroyed zappar_face_landmark_t\");\n                return;\n            }\n            obj.update(identity, expression, mirrored);\n        }, face_landmark_anchor_pose: (m) => {\n            let obj = facelandmark_1.getFaceLandmark(m);\n            if (!obj) {\n                loglevel_1.zcwarn(\"attempting to call face_landmark_anchor_pose on a destroyed zappar_face_landmark_t\");\n                return gl_matrix_1.mat4.create();\n            }\n            return obj.anchor_pose;\n        }, html_element_source_create: (pipeline, elm) => html_element_source_1.HTMLElementSource.createVideoElementSource(pipeline, elm), html_element_source_start: o => { var _a; return (_a = html_element_source_1.HTMLElementSource.getVideoElementSource(o)) === null || _a === void 0 ? void 0 : _a.start(); }, html_element_source_pause: o => { var _a; return (_a = html_element_source_1.HTMLElementSource.getVideoElementSource(o)) === null || _a === void 0 ? void 0 : _a.pause(); }, html_element_source_destroy: o => { var _a; return (_a = html_element_source_1.HTMLElementSource.getVideoElementSource(o)) === null || _a === void 0 ? void 0 : _a.destroy(); }, permission_granted_all: permission_1.permissionGrantedAll, permission_granted_camera: permission_1.permissionGrantedCamera, permission_granted_motion: permission_1.permissionGrantedMotion, permission_denied_any: permission_1.permissionDeniedAny, permission_denied_camera: permission_1.permissionDeniedCamera, permission_denied_motion: permission_1.permissionDeniedMotion, permission_request_motion: permission_1.permissionRequestMotion, permission_request_camera: permission_1.permissionRequestCamera, permission_request_all: permission_1.permissionRequestAll, permission_request_ui: permission_1.permissionRequestUI, permission_request_ui_promise: permission_1.permissionRequestUI, permission_denied_ui: permission_1.permissionDeniedUI, browser_incompatible: compatibility_1.default.incompatible, browser_incompatible_ui: compatibility_1.default.incompatible_ui, log_level_set: l => {\n            loglevel_1.setLogLevel(l);\n            c.impl.log_level_set(l);\n        } });\n    return client;\n}\nexports.initialize = initialize;\nfunction loadDefaultFaceModel(o) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let url = require(\"file-loader!./face_tracking_model.zbin\");\n        if (url.default !== undefined)\n            url = url.default;\n        let data = yield fetch(url);\n        let ab = yield data.arrayBuffer();\n        client === null || client === void 0 ? void 0 : client.face_tracker_model_load_from_memory(o, ab);\n    });\n}\n"]},"metadata":{},"sourceType":"script"}