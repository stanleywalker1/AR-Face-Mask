{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.permissionDeniedUI = exports.permissionRequestUI = exports.permissionRequestMotion = exports.permissionRequestCamera = exports.permissionRequestAll = exports.permissionGrantedAll = exports.permissionDeniedAny = exports.permissionDeniedMotion = exports.permissionDeniedCamera = exports.permissionGrantedMotion = exports.permissionGrantedCamera = void 0;\n\nconst ua_parser_js_1 = require(\"ua-parser-js\");\n\nlet parser = new ua_parser_js_1.UAParser();\nlet _permissionGrantedCamera = false;\nlet _permissionGrantedMotion = false;\nlet _permissionDeniedCamera = false;\nlet _permissionDeniedMotion = false;\n\nif (!window.DeviceOrientationEvent || !window.DeviceOrientationEvent.requestPermission) {\n  _permissionGrantedMotion = true;\n}\n\nfunction checkForCameraPermission() {\n  return __awaiter(this, void 0, void 0, function* () {\n    if (navigator.permissions && navigator.permissions.query) {\n      try {\n        let res = yield navigator.permissions.query({\n          name: \"camera\"\n        });\n        _permissionDeniedCamera = res.state === 'denied';\n        _permissionGrantedCamera = res.state === 'granted';\n      } catch (ex) {}\n    }\n  });\n}\n\ncheckForCameraPermission();\n\nfunction permissionGrantedCamera() {\n  return _permissionGrantedCamera;\n}\n\nexports.permissionGrantedCamera = permissionGrantedCamera;\n\nfunction permissionGrantedMotion() {\n  return _permissionGrantedMotion;\n}\n\nexports.permissionGrantedMotion = permissionGrantedMotion;\n\nfunction permissionDeniedCamera() {\n  return _permissionDeniedCamera;\n}\n\nexports.permissionDeniedCamera = permissionDeniedCamera;\n\nfunction permissionDeniedMotion() {\n  return _permissionDeniedMotion;\n}\n\nexports.permissionDeniedMotion = permissionDeniedMotion;\n\nfunction permissionDeniedAny() {\n  return _permissionDeniedCamera || _permissionDeniedMotion;\n}\n\nexports.permissionDeniedAny = permissionDeniedAny;\n\nfunction permissionGrantedAll() {\n  return _permissionGrantedCamera && _permissionGrantedMotion;\n}\n\nexports.permissionGrantedAll = permissionGrantedAll;\n\nfunction permissionRequestAll() {\n  return __awaiter(this, void 0, void 0, function* () {\n    yield permissionRequestMotion();\n    yield permissionRequestCamera();\n  });\n}\n\nexports.permissionRequestAll = permissionRequestAll;\n\nfunction permissionRequestCamera() {\n  return __awaiter(this, void 0, void 0, function* () {\n    try {\n      let res = yield navigator.mediaDevices.getUserMedia({\n        video: true\n      });\n      let tracks = res.getTracks();\n      tracks.forEach(t => t.stop());\n      _permissionGrantedCamera = true;\n      _permissionDeniedCamera = false;\n    } catch (err) {\n      _permissionGrantedCamera = false;\n      _permissionDeniedCamera = true;\n    }\n  });\n}\n\nexports.permissionRequestCamera = permissionRequestCamera;\n\nfunction permissionRequestMotion() {\n  return __awaiter(this, void 0, void 0, function* () {\n    if (window.DeviceOrientationEvent && window.DeviceOrientationEvent.requestPermission) {\n      let permissionResult = yield window.DeviceOrientationEvent.requestPermission();\n\n      if (permissionResult !== 'granted') {\n        _permissionGrantedMotion = false;\n        _permissionDeniedMotion = true;\n        return false;\n      }\n    } // No motion permissions or granted\n\n\n    _permissionGrantedMotion = true;\n    _permissionDeniedMotion = false;\n  });\n}\n\nexports.permissionRequestMotion = permissionRequestMotion;\n\nfunction permissionRequestUI() {\n  return __awaiter(this, void 0, void 0, function* () {\n    yield checkForCameraPermission();\n\n    if (permissionGrantedAll()) {\n      return true;\n    }\n\n    let div = document.createElement(\"div\");\n    div.classList.add(\"zappar-permission-request\");\n    div.innerHTML = `\n    <style>\n        .zappar-permission-request {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            top: 0px;\n            left: 0px;\n            z-index: 1000;\n            background-color: rgba(0, 0, 0, 0.9);\n            font-family: sans-serif;\n            color: white;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        .zappar-inner {\n            max-width: 400px;\n            text-align: center;\n        }\n        .zappar-title {\n            font-size: 20px;\n        }\n        .zappar-text {\n            font-size: 14px;\n            padding: 15px;\n        }\n        .zappar-inner > button {\n            background: none;\n            outline: none;\n            border: 2px solid white;\n            border-radius: 10px;\n            color: white;\n            padding: 10px 40px;\n            text-transform: uppercase;\n        }\n    </style>\n    <div class=\"zappar-inner\">\n        <div class=\"zappar-title\">Almost there...</div>\n        <div class=\"zappar-text\">In order to provide this augmented reality experience, we need access to your device's camera and motion sensors.</div>\n        <button id=\"zappar-permission-request-button\">Grant Access</button>\n    </div>\n`;\n    document.body.append(div);\n    let button = div.querySelector(\"#zappar-permission-request-button\");\n    return yield new Promise(resolve => {\n      button === null || button === void 0 ? void 0 : button.addEventListener(\"click\", () => __awaiter(this, void 0, void 0, function* () {\n        yield permissionRequestAll();\n        div.remove();\n\n        while (true) {\n          yield nextFrame();\n\n          if (permissionDeniedAny()) {\n            resolve(false);\n            return;\n          }\n\n          if (permissionGrantedAll()) {\n            resolve(true);\n            return;\n          }\n        }\n      }));\n    });\n  });\n}\n\nexports.permissionRequestUI = permissionRequestUI;\n\nfunction nextFrame() {\n  return new Promise(resolve => requestAnimationFrame(() => resolve()));\n}\n\nfunction permissionDeniedUI() {\n  switch (parser.getBrowser().name) {\n    case \"Chrome\":\n      permissionDeniedUIChrome();\n      break;\n\n    default:\n      permissionDeniedUIIOS();\n      break;\n  }\n}\n\nexports.permissionDeniedUI = permissionDeniedUI;\n\nfunction permissionDeniedUIIOS() {\n  let div = document.createElement(\"div\");\n  div.classList.add(\"zappar-permission-request\");\n  div.innerHTML = `\n    <style>\n        .zappar-permission-request {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            top: 0px;\n            left: 0px;\n            z-index: 1000;\n            background-color: rgba(0, 0, 0, 0.9);\n            font-family: sans-serif;\n            color: white;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        .zappar-inner {\n            max-width: 400px;\n            text-align: center;\n        }\n        .zappar-title {\n            font-size: 20px;\n        }\n        .zappar-text {\n            font-size: 14px;\n            padding: 15px;\n        }\n        .zappar-inner > button {\n            background: none;\n            outline: none;\n            border: 2px solid white;\n            border-radius: 10px;\n            color: white;\n            padding: 10px 40px;\n            text-transform: uppercase;\n        }\n    </style>\n    <div class=\"zappar-inner\">\n        <div class=\"zappar-title\">Permission is Needed</div>\n        <div class=\"zappar-text\">Permission to access your device's camera and motion sensors is necessary for this experience. Please reload the page to try again.</div>\n        <button id=\"zappar-permission-reload-button\">Reload</button>\n    </div>\n`;\n  document.body.append(div);\n  let button = div.querySelector(\"#zappar-permission-reload-button\");\n  button === null || button === void 0 ? void 0 : button.addEventListener(\"click\", () => window.location.reload());\n}\n\nfunction permissionDeniedUIChrome() {\n  let div = document.createElement(\"div\");\n  div.classList.add(\"zappar-permission-request\");\n  div.innerHTML = `\n    <style>\n        .zappar-permission-request {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            top: 0px;\n            left: 0px;\n            z-index: 1000;\n            background-color: rgba(0, 0, 0, 0.9);\n            font-family: sans-serif;\n            color: white;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        .zappar-inner {\n            width: 400px;\n            text-align: center;\n        }\n        .zappar-title {\n            font-size: 20px;\n        }\n        .zappar-text {\n            font-size: 14px;\n            padding: 15px;\n        }\n        .zappar-inner > button {\n            background: none;\n            outline: none;\n            border: 2px solid white;\n            border-radius: 10px;\n            color: white;\n            padding: 10px 40px;\n            text-transform: uppercase;\n        }\n    </style>\n    <div class=\"zappar-inner\">\n        <div class=\"zappar-title\">Permission is Needed</div>\n        <div class=\"zappar-text\">Permission to access your device's camera and motion sensors is necessary for this experience.<br/><br/>To grant access, please tap the ! button in the address bar of your browser, then \"Site settings\", and finally \"Clear and reset\". You can then reload the page to try again.</div>\n        <button id=\"zappar-permission-reload-button\">Reload</button>\n    </div>\n`;\n  document.body.append(div);\n  let button = div.querySelector(\"#zappar-permission-reload-button\");\n  button === null || button === void 0 ? void 0 : button.addEventListener(\"click\", () => window.location.reload());\n}","map":{"version":3,"sources":["/Users/StanleyWalker/Desktop/react-three-example-face-tracking-helmet-1/node_modules/@zappar/zappar-cv/lib/permission.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","permissionDeniedUI","permissionRequestUI","permissionRequestMotion","permissionRequestCamera","permissionRequestAll","permissionGrantedAll","permissionDeniedAny","permissionDeniedMotion","permissionDeniedCamera","permissionGrantedMotion","permissionGrantedCamera","ua_parser_js_1","require","parser","UAParser","_permissionGrantedCamera","_permissionGrantedMotion","_permissionDeniedCamera","_permissionDeniedMotion","window","DeviceOrientationEvent","requestPermission","checkForCameraPermission","navigator","permissions","query","res","name","state","ex","mediaDevices","getUserMedia","video","tracks","getTracks","forEach","t","stop","err","permissionResult","div","document","createElement","classList","add","innerHTML","body","append","button","querySelector","addEventListener","remove","nextFrame","requestAnimationFrame","getBrowser","permissionDeniedUIChrome","permissionDeniedUIIOS","location","reload"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.permissionDeniedUI = exports.permissionRequestUI = exports.permissionRequestMotion = exports.permissionRequestCamera = exports.permissionRequestAll = exports.permissionGrantedAll = exports.permissionDeniedAny = exports.permissionDeniedMotion = exports.permissionDeniedCamera = exports.permissionGrantedMotion = exports.permissionGrantedCamera = void 0;\nconst ua_parser_js_1 = require(\"ua-parser-js\");\nlet parser = new ua_parser_js_1.UAParser();\nlet _permissionGrantedCamera = false;\nlet _permissionGrantedMotion = false;\nlet _permissionDeniedCamera = false;\nlet _permissionDeniedMotion = false;\nif (!window.DeviceOrientationEvent || !window.DeviceOrientationEvent.requestPermission) {\n    _permissionGrantedMotion = true;\n}\nfunction checkForCameraPermission() {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (navigator.permissions && navigator.permissions.query) {\n            try {\n                let res = yield navigator.permissions.query({ name: \"camera\" });\n                _permissionDeniedCamera = res.state === 'denied';\n                _permissionGrantedCamera = res.state === 'granted';\n            }\n            catch (ex) { }\n        }\n    });\n}\ncheckForCameraPermission();\nfunction permissionGrantedCamera() { return _permissionGrantedCamera; }\nexports.permissionGrantedCamera = permissionGrantedCamera;\nfunction permissionGrantedMotion() { return _permissionGrantedMotion; }\nexports.permissionGrantedMotion = permissionGrantedMotion;\nfunction permissionDeniedCamera() { return _permissionDeniedCamera; }\nexports.permissionDeniedCamera = permissionDeniedCamera;\nfunction permissionDeniedMotion() { return _permissionDeniedMotion; }\nexports.permissionDeniedMotion = permissionDeniedMotion;\nfunction permissionDeniedAny() { return _permissionDeniedCamera || _permissionDeniedMotion; }\nexports.permissionDeniedAny = permissionDeniedAny;\nfunction permissionGrantedAll() { return _permissionGrantedCamera && _permissionGrantedMotion; }\nexports.permissionGrantedAll = permissionGrantedAll;\nfunction permissionRequestAll() {\n    return __awaiter(this, void 0, void 0, function* () {\n        yield permissionRequestMotion();\n        yield permissionRequestCamera();\n    });\n}\nexports.permissionRequestAll = permissionRequestAll;\nfunction permissionRequestCamera() {\n    return __awaiter(this, void 0, void 0, function* () {\n        try {\n            let res = yield navigator.mediaDevices.getUserMedia({\n                video: true\n            });\n            let tracks = res.getTracks();\n            tracks.forEach(t => t.stop());\n            _permissionGrantedCamera = true;\n            _permissionDeniedCamera = false;\n        }\n        catch (err) {\n            _permissionGrantedCamera = false;\n            _permissionDeniedCamera = true;\n        }\n    });\n}\nexports.permissionRequestCamera = permissionRequestCamera;\nfunction permissionRequestMotion() {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (window.DeviceOrientationEvent && window.DeviceOrientationEvent.requestPermission) {\n            let permissionResult = yield window.DeviceOrientationEvent.requestPermission();\n            if (permissionResult !== 'granted') {\n                _permissionGrantedMotion = false;\n                _permissionDeniedMotion = true;\n                return false;\n            }\n        }\n        // No motion permissions or granted\n        _permissionGrantedMotion = true;\n        _permissionDeniedMotion = false;\n    });\n}\nexports.permissionRequestMotion = permissionRequestMotion;\nfunction permissionRequestUI() {\n    return __awaiter(this, void 0, void 0, function* () {\n        yield checkForCameraPermission();\n        if (permissionGrantedAll()) {\n            return true;\n        }\n        let div = document.createElement(\"div\");\n        div.classList.add(\"zappar-permission-request\");\n        div.innerHTML = `\n    <style>\n        .zappar-permission-request {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            top: 0px;\n            left: 0px;\n            z-index: 1000;\n            background-color: rgba(0, 0, 0, 0.9);\n            font-family: sans-serif;\n            color: white;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        .zappar-inner {\n            max-width: 400px;\n            text-align: center;\n        }\n        .zappar-title {\n            font-size: 20px;\n        }\n        .zappar-text {\n            font-size: 14px;\n            padding: 15px;\n        }\n        .zappar-inner > button {\n            background: none;\n            outline: none;\n            border: 2px solid white;\n            border-radius: 10px;\n            color: white;\n            padding: 10px 40px;\n            text-transform: uppercase;\n        }\n    </style>\n    <div class=\"zappar-inner\">\n        <div class=\"zappar-title\">Almost there...</div>\n        <div class=\"zappar-text\">In order to provide this augmented reality experience, we need access to your device's camera and motion sensors.</div>\n        <button id=\"zappar-permission-request-button\">Grant Access</button>\n    </div>\n`;\n        document.body.append(div);\n        let button = div.querySelector(\"#zappar-permission-request-button\");\n        return yield new Promise(resolve => {\n            button === null || button === void 0 ? void 0 : button.addEventListener(\"click\", () => __awaiter(this, void 0, void 0, function* () {\n                yield permissionRequestAll();\n                div.remove();\n                while (true) {\n                    yield nextFrame();\n                    if (permissionDeniedAny()) {\n                        resolve(false);\n                        return;\n                    }\n                    if (permissionGrantedAll()) {\n                        resolve(true);\n                        return;\n                    }\n                }\n            }));\n        });\n    });\n}\nexports.permissionRequestUI = permissionRequestUI;\nfunction nextFrame() {\n    return new Promise(resolve => requestAnimationFrame(() => resolve()));\n}\nfunction permissionDeniedUI() {\n    switch (parser.getBrowser().name) {\n        case \"Chrome\":\n            permissionDeniedUIChrome();\n            break;\n        default:\n            permissionDeniedUIIOS();\n            break;\n    }\n}\nexports.permissionDeniedUI = permissionDeniedUI;\nfunction permissionDeniedUIIOS() {\n    let div = document.createElement(\"div\");\n    div.classList.add(\"zappar-permission-request\");\n    div.innerHTML = `\n    <style>\n        .zappar-permission-request {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            top: 0px;\n            left: 0px;\n            z-index: 1000;\n            background-color: rgba(0, 0, 0, 0.9);\n            font-family: sans-serif;\n            color: white;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        .zappar-inner {\n            max-width: 400px;\n            text-align: center;\n        }\n        .zappar-title {\n            font-size: 20px;\n        }\n        .zappar-text {\n            font-size: 14px;\n            padding: 15px;\n        }\n        .zappar-inner > button {\n            background: none;\n            outline: none;\n            border: 2px solid white;\n            border-radius: 10px;\n            color: white;\n            padding: 10px 40px;\n            text-transform: uppercase;\n        }\n    </style>\n    <div class=\"zappar-inner\">\n        <div class=\"zappar-title\">Permission is Needed</div>\n        <div class=\"zappar-text\">Permission to access your device's camera and motion sensors is necessary for this experience. Please reload the page to try again.</div>\n        <button id=\"zappar-permission-reload-button\">Reload</button>\n    </div>\n`;\n    document.body.append(div);\n    let button = div.querySelector(\"#zappar-permission-reload-button\");\n    button === null || button === void 0 ? void 0 : button.addEventListener(\"click\", () => window.location.reload());\n}\nfunction permissionDeniedUIChrome() {\n    let div = document.createElement(\"div\");\n    div.classList.add(\"zappar-permission-request\");\n    div.innerHTML = `\n    <style>\n        .zappar-permission-request {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            top: 0px;\n            left: 0px;\n            z-index: 1000;\n            background-color: rgba(0, 0, 0, 0.9);\n            font-family: sans-serif;\n            color: white;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        .zappar-inner {\n            width: 400px;\n            text-align: center;\n        }\n        .zappar-title {\n            font-size: 20px;\n        }\n        .zappar-text {\n            font-size: 14px;\n            padding: 15px;\n        }\n        .zappar-inner > button {\n            background: none;\n            outline: none;\n            border: 2px solid white;\n            border-radius: 10px;\n            color: white;\n            padding: 10px 40px;\n            text-transform: uppercase;\n        }\n    </style>\n    <div class=\"zappar-inner\">\n        <div class=\"zappar-title\">Permission is Needed</div>\n        <div class=\"zappar-text\">Permission to access your device's camera and motion sensors is necessary for this experience.<br/><br/>To grant access, please tap the ! button in the address bar of your browser, then \"Site settings\", and finally \"Clear and reset\". You can then reload the page to try again.</div>\n        <button id=\"zappar-permission-reload-button\">Reload</button>\n    </div>\n`;\n    document.body.append(div);\n    let button = div.querySelector(\"#zappar-permission-reload-button\");\n    button === null || button === void 0 ? void 0 : button.addEventListener(\"click\", () => window.location.reload());\n}\n"]},"metadata":{},"sourceType":"script"}