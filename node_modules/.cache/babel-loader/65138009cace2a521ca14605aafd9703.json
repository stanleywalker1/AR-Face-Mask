{"ast":null,"code":"\"use strict\";\n/* eslint-disable guard-for-in */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LoadingManager = exports.DefaultLoaderUI = void 0;\n\nconst three_1 = require(\"../three\");\n\nconst libraryloader_1 = require(\"./libraryloader\");\n\nclass UI {\n  constructor(style) {\n    this.lastLoadPercentage = 0;\n    this.divs = {\n      inner: document.createElement(\"div\"),\n      title: document.createElement(\"div\"),\n      progress: document.createElement(\"div\"),\n      progressValue: document.createElement(\"div\")\n    };\n    this.css = {\n      container: {\n        position: \"fixed\",\n        width: \"100%\",\n        height: \"100%\",\n        top: \"0px\",\n        left: \"0px\",\n        zIndex: \"10000\",\n        backgroundColor: \"rgba(0,0,0,0.8)\",\n        fontFamily: \"sans-serif\",\n        color: \"rgba(255,255,255,1)\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        transition: \"opacity 500ms\"\n      },\n      inner: {\n        maxWidth: \"400px\",\n        textAlign: \"center\"\n      },\n      title: {\n        fontSize: \"20px\"\n      },\n      progress: {\n        background: \"rgba(255,255,255, 0.1)\",\n        justifyContent: \"flex-start\",\n        borderRadius: \"100px\",\n        alignItems: \"center\",\n        position: \"relative\",\n        padding: \"0 5px\",\n        display: \"flex\",\n        height: \"15px\",\n        width: \"250px\",\n        margin: \"15px\"\n      },\n      progressValue: {\n        boxShadow: \"0 10px 40px -10px #fff\",\n        borderTopLeftRadius: \"100px\",\n        borderBottomLeftRadius: \"100px\",\n        background: \"rgba(255,255,255,1)\",\n        height: \"10px\",\n        width: \"0\",\n        transition: \"width 500ms\"\n      }\n    }; // update loading bar based on % = (n-loaded / n-total * 100)\n\n    this.updateLoader = loadPercentage => {\n      if (loadPercentage < this.lastLoadPercentage) return;\n      this.lastLoadPercentage = loadPercentage;\n      const elem = document.getElementById(\"zappar-loader-progressValue\");\n      elem.style.width = `${loadPercentage}%`;\n      elem.style.borderTopRightRadius = `${loadPercentage}px`;\n      elem.style.borderBottomRightRadius = `${loadPercentage}px`;\n      elem.addEventListener(\"transitionend\", () => {\n        if (loadPercentage === 100) {\n          this.containerDiv.style.opacity = \"0\";\n          this.containerDiv.addEventListener(\"transitionend\", ev => {\n            if (ev.propertyName === \"opacity\") {\n              this.dispose();\n            }\n          });\n        }\n      });\n    };\n\n    this.dispose = () => {\n      this.containerDiv.remove();\n    };\n\n    this.customStyle = style;\n    this.containerDiv = document.createElement(\"div\");\n  }\n\n  initialize() {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const key in this.divs) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      this.divs[key].id = `zappar-loader-${key}`;\n    }\n\n    this.refreshStyle();\n    this.divs.inner.appendChild(this.divs.title);\n    this.divs.inner.appendChild(this.divs.progress);\n    this.divs.progress.appendChild(this.divs.progressValue);\n    this.containerDiv.appendChild(this.divs.inner);\n    this.divs.title.innerHTML = \"Loading..\";\n    document.body.append(this.containerDiv);\n  }\n\n  refreshStyle() {\n    var _a, _b, _c, _d, _e;\n\n    Object.assign(this.css.container, (_a = this.customStyle) === null || _a === void 0 ? void 0 : _a.container);\n    Object.assign(this.css.inner, (_b = this.customStyle) === null || _b === void 0 ? void 0 : _b.inner);\n    Object.assign(this.css.title, (_c = this.customStyle) === null || _c === void 0 ? void 0 : _c.title);\n    Object.assign(this.css.progress, (_d = this.customStyle) === null || _d === void 0 ? void 0 : _d.progress);\n    Object.assign(this.css.progressValue, (_e = this.customStyle) === null || _e === void 0 ? void 0 : _e.progressValue);\n    Object.assign(this.containerDiv.style, this.css.container);\n    Object.assign(this.divs.inner.style, this.css.inner);\n    Object.assign(this.divs.title.style, this.css.title);\n    Object.assign(this.divs.progress.style, this.css.progress);\n    Object.assign(this.divs.progressValue.style, this.css.progressValue);\n  }\n\n}\n/**\n * Creates a THREE.DefaultLoadingManager which is applied to all assets that can be loaded.\n * @see https://docs.zap.works/universal-ar/web-libraries/threejs/loading-manager/\n */\n\n\nclass DefaultLoaderUI extends UI {\n  /**\n   * Constructs a new DefaultLoaderUI.\n   * @param options - The styling of the UI.\n   * @param onload - The callback function to be called when assets are loaded.\n   */\n  constructor(options) {\n    super(options === null || options === void 0 ? void 0 : options.style);\n\n    three_1.THREE.DefaultLoadingManager.onStart = () => {\n      this.initialize();\n    };\n\n    three_1.THREE.DefaultLoadingManager.onLoad = () => {\n      var _a;\n\n      (_a = options === null || options === void 0 ? void 0 : options.onLoad) === null || _a === void 0 ? void 0 : _a.call(options);\n    };\n\n    three_1.THREE.DefaultLoadingManager.onProgress = (_url, itemsLoaded, itemsTotal) => {\n      this.updateLoader(itemsLoaded / itemsTotal * 100);\n    };\n  }\n\n}\n\nexports.DefaultLoaderUI = DefaultLoaderUI;\n/**\n * A LoadingManager with a user friendly interface.\n * @see https://docs.zap.works/universal-ar/web-libraries/threejs/loading-manager/\n */\n\nclass LoadingManager extends three_1.THREE.LoadingManager {\n  /**\n   * Constructs a new LoadingManager.\n   * @param options - Styling may be defined here, as well as any event callbacks.\n   */\n  constructor(options) {\n    super(() => {\n      var _a;\n\n      return (_a = options === null || options === void 0 ? void 0 : options.onLoad) === null || _a === void 0 ? void 0 : _a.call(options);\n    }, (url, loaded, total) => {\n      var _a;\n\n      this.ui.customStyle = options === null || options === void 0 ? void 0 : options.style;\n      this.ui.refreshStyle();\n      (_a = options === null || options === void 0 ? void 0 : options.onProgress) === null || _a === void 0 ? void 0 : _a.call(options, url, loaded, total);\n      this.ui.updateLoader(loaded / total * 100);\n    }, options === null || options === void 0 ? void 0 : options.onError);\n    this.ui = new UI(); // no multiple inheritance (╯°□°)╯︵ ┻━┻\n\n    this.onStartCallback = undefined;\n    /**\n     * @ignore\n     */\n\n    this.onStart = () => {\n      this.ui.initialize();\n      if (this.onStartCallback) this.onStartCallback();\n    };\n    /**\n     * Calls provided function when loading begins.\n     * @param callback - Function that is called when loading starts.\n     */\n\n\n    this._onStart = callback => {\n      this.onStartCallback = callback;\n    };\n    /**\n     * Destroys the UI.\n     */\n\n\n    this.dispose = () => {\n      this.ui.dispose();\n    };\n\n    new libraryloader_1.LibraryLoader(this).load();\n  }\n\n}\n\nexports.LoadingManager = LoadingManager;","map":{"version":3,"sources":["/Users/StanleyWalker/Desktop/face-mask-demo/AR-Face-Mask/node_modules/@zappar/zappar-threejs/lib/loaders/loadingmanager.js"],"names":["Object","defineProperty","exports","value","LoadingManager","DefaultLoaderUI","three_1","require","libraryloader_1","UI","constructor","style","lastLoadPercentage","divs","inner","document","createElement","title","progress","progressValue","css","container","position","width","height","top","left","zIndex","backgroundColor","fontFamily","color","display","flexDirection","alignItems","justifyContent","transition","maxWidth","textAlign","fontSize","background","borderRadius","padding","margin","boxShadow","borderTopLeftRadius","borderBottomLeftRadius","updateLoader","loadPercentage","elem","getElementById","borderTopRightRadius","borderBottomRightRadius","addEventListener","containerDiv","opacity","ev","propertyName","dispose","remove","customStyle","initialize","key","id","refreshStyle","appendChild","innerHTML","body","append","_a","_b","_c","_d","_e","assign","options","THREE","DefaultLoadingManager","onStart","onLoad","call","onProgress","_url","itemsLoaded","itemsTotal","url","loaded","total","ui","onError","onStartCallback","undefined","_onStart","callback","LibraryLoader","load"],"mappings":"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","sourcesContent":["\"use strict\";\n/* eslint-disable guard-for-in */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LoadingManager = exports.DefaultLoaderUI = void 0;\nconst three_1 = require(\"../three\");\nconst libraryloader_1 = require(\"./libraryloader\");\nclass UI {\n    constructor(style) {\n        this.lastLoadPercentage = 0;\n        this.divs = {\n            inner: document.createElement(\"div\"),\n            title: document.createElement(\"div\"),\n            progress: document.createElement(\"div\"),\n            progressValue: document.createElement(\"div\"),\n        };\n        this.css = {\n            container: {\n                position: \"fixed\",\n                width: \"100%\",\n                height: \"100%\",\n                top: \"0px\",\n                left: \"0px\",\n                zIndex: \"10000\",\n                backgroundColor: \"rgba(0,0,0,0.8)\",\n                fontFamily: \"sans-serif\",\n                color: \"rgba(255,255,255,1)\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                transition: \"opacity 500ms\",\n            },\n            inner: {\n                maxWidth: \"400px\",\n                textAlign: \"center\",\n            },\n            title: {\n                fontSize: \"20px\",\n            },\n            progress: {\n                background: \"rgba(255,255,255, 0.1)\",\n                justifyContent: \"flex-start\",\n                borderRadius: \"100px\",\n                alignItems: \"center\",\n                position: \"relative\",\n                padding: \"0 5px\",\n                display: \"flex\",\n                height: \"15px\",\n                width: \"250px\",\n                margin: \"15px\",\n            },\n            progressValue: {\n                boxShadow: \"0 10px 40px -10px #fff\",\n                borderTopLeftRadius: \"100px\",\n                borderBottomLeftRadius: \"100px\",\n                background: \"rgba(255,255,255,1)\",\n                height: \"10px\",\n                width: \"0\",\n                transition: \"width 500ms\",\n            },\n        };\n        // update loading bar based on % = (n-loaded / n-total * 100)\n        this.updateLoader = (loadPercentage) => {\n            if (loadPercentage < this.lastLoadPercentage)\n                return;\n            this.lastLoadPercentage = loadPercentage;\n            const elem = document.getElementById(\"zappar-loader-progressValue\");\n            elem.style.width = `${loadPercentage}%`;\n            elem.style.borderTopRightRadius = `${loadPercentage}px`;\n            elem.style.borderBottomRightRadius = `${loadPercentage}px`;\n            elem.addEventListener(\"transitionend\", () => {\n                if (loadPercentage === 100) {\n                    this.containerDiv.style.opacity = \"0\";\n                    this.containerDiv.addEventListener(\"transitionend\", (ev) => {\n                        if (ev.propertyName === \"opacity\") {\n                            this.dispose();\n                        }\n                    });\n                }\n            });\n        };\n        this.dispose = () => {\n            this.containerDiv.remove();\n        };\n        this.customStyle = style;\n        this.containerDiv = document.createElement(\"div\");\n    }\n    initialize() {\n        // eslint-disable-next-line no-restricted-syntax\n        for (const key in this.divs) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.divs[key].id = `zappar-loader-${key}`;\n        }\n        this.refreshStyle();\n        this.divs.inner.appendChild(this.divs.title);\n        this.divs.inner.appendChild(this.divs.progress);\n        this.divs.progress.appendChild(this.divs.progressValue);\n        this.containerDiv.appendChild(this.divs.inner);\n        this.divs.title.innerHTML = \"Loading..\";\n        document.body.append(this.containerDiv);\n    }\n    refreshStyle() {\n        var _a, _b, _c, _d, _e;\n        Object.assign(this.css.container, (_a = this.customStyle) === null || _a === void 0 ? void 0 : _a.container);\n        Object.assign(this.css.inner, (_b = this.customStyle) === null || _b === void 0 ? void 0 : _b.inner);\n        Object.assign(this.css.title, (_c = this.customStyle) === null || _c === void 0 ? void 0 : _c.title);\n        Object.assign(this.css.progress, (_d = this.customStyle) === null || _d === void 0 ? void 0 : _d.progress);\n        Object.assign(this.css.progressValue, (_e = this.customStyle) === null || _e === void 0 ? void 0 : _e.progressValue);\n        Object.assign(this.containerDiv.style, this.css.container);\n        Object.assign(this.divs.inner.style, this.css.inner);\n        Object.assign(this.divs.title.style, this.css.title);\n        Object.assign(this.divs.progress.style, this.css.progress);\n        Object.assign(this.divs.progressValue.style, this.css.progressValue);\n    }\n}\n/**\n * Creates a THREE.DefaultLoadingManager which is applied to all assets that can be loaded.\n * @see https://docs.zap.works/universal-ar/web-libraries/threejs/loading-manager/\n */\nclass DefaultLoaderUI extends UI {\n    /**\n     * Constructs a new DefaultLoaderUI.\n     * @param options - The styling of the UI.\n     * @param onload - The callback function to be called when assets are loaded.\n     */\n    constructor(options) {\n        super(options === null || options === void 0 ? void 0 : options.style);\n        three_1.THREE.DefaultLoadingManager.onStart = () => {\n            this.initialize();\n        };\n        three_1.THREE.DefaultLoadingManager.onLoad = () => {\n            var _a;\n            (_a = options === null || options === void 0 ? void 0 : options.onLoad) === null || _a === void 0 ? void 0 : _a.call(options);\n        };\n        three_1.THREE.DefaultLoadingManager.onProgress = (_url, itemsLoaded, itemsTotal) => {\n            this.updateLoader((itemsLoaded / itemsTotal) * 100);\n        };\n    }\n}\nexports.DefaultLoaderUI = DefaultLoaderUI;\n/**\n * A LoadingManager with a user friendly interface.\n * @see https://docs.zap.works/universal-ar/web-libraries/threejs/loading-manager/\n */\nclass LoadingManager extends three_1.THREE.LoadingManager {\n    /**\n     * Constructs a new LoadingManager.\n     * @param options - Styling may be defined here, as well as any event callbacks.\n     */\n    constructor(options) {\n        super(() => { var _a; return (_a = options === null || options === void 0 ? void 0 : options.onLoad) === null || _a === void 0 ? void 0 : _a.call(options); }, (url, loaded, total) => {\n            var _a;\n            this.ui.customStyle = options === null || options === void 0 ? void 0 : options.style;\n            this.ui.refreshStyle();\n            (_a = options === null || options === void 0 ? void 0 : options.onProgress) === null || _a === void 0 ? void 0 : _a.call(options, url, loaded, total);\n            this.ui.updateLoader((loaded / total) * 100);\n        }, options === null || options === void 0 ? void 0 : options.onError);\n        this.ui = new UI(); // no multiple inheritance (╯°□°)╯︵ ┻━┻\n        this.onStartCallback = undefined;\n        /**\n         * @ignore\n         */\n        this.onStart = () => {\n            this.ui.initialize();\n            if (this.onStartCallback)\n                this.onStartCallback();\n        };\n        /**\n         * Calls provided function when loading begins.\n         * @param callback - Function that is called when loading starts.\n         */\n        this._onStart = (callback) => {\n            this.onStartCallback = callback;\n        };\n        /**\n         * Destroys the UI.\n         */\n        this.dispose = () => {\n            this.ui.dispose();\n        };\n        new libraryloader_1.LibraryLoader(this).load();\n    }\n}\nexports.LoadingManager = LoadingManager;\n"]},"metadata":{},"sourceType":"script"}